<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>KiddoQuest</title>
    <!-- Tailwind CSS CDN is fine for simple usage. For production speed, installing via npm is recommended later. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800;900&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Nunito', sans-serif;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
      }
      @keyframes bounce-in {
        0% { transform: scale(0.3); opacity: 0; }
        50% { transform: scale(1.05); opacity: 1; }
        70% { transform: scale(0.9); }
        100% { transform: scale(1); }
      }
      .animate-bounce-in {
        animation: bounce-in 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
    </style>

<!-- <link rel="stylesheet" href="index.css"> -->
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/",
    "@google/genai": "https://esm.sh/@google/genai@^1.37.0",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0",
    "vite": "https://esm.sh/vite@^7.3.1",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.2"
  }
}
</script>
  <script type="module" crossorigin src="./assets/index-30fa8bd8.js"></script>
</head>
  <body>
    <div id="root"></div>
    
    <script>
      // Cải thiện giọng đọc Tiếng Việt chuẩn cho Android/Chrome
      (function() {
        let viVoice = null;

        function loadVoices() {
          const voices = window.speechSynthesis.getVoices();
          viVoice = voices.find(v => v.lang.includes('vi-VN') && (v.name.includes('Google') || v.name.includes('Microsoft'))) || 
                    voices.find(v => v.lang.includes('vi-VN'));
        }

        if (window.speechSynthesis.onvoiceschanged !== undefined) {
          window.speechSynthesis.onvoiceschanged = loadVoices;
        }
        loadVoices();

        const originalSpeak = window.speechSynthesis.speak;
        window.speechSynthesis.speak = function(utterance) {
          // Tự động nhận diện tiếng Việt nếu text có dấu hoặc lang là vi
          if (utterance.lang.includes('vi') || /[\u0300-\u036f\u1ea0-\u1ef9]/.test(utterance.text)) {
            if (!viVoice) loadVoices(); // Thử load lại nếu chưa có
            
            if (viVoice) {
              utterance.voice = viVoice;
              utterance.lang = 'vi-VN';
            } else {
              utterance.lang = 'vi-VN'; // Fallback lang
            }
            
            // Tối ưu cho Android
            utterance.rate = utterance.rate || 0.85; 
            utterance.pitch = utterance.pitch || 1.0;
            utterance.volume = utterance.volume || 1.0;
          }
          
          // Đảm bảo speechSynthesis không bị treo
          window.speechSynthesis.cancel();
          originalSpeak.call(window.speechSynthesis, utterance);
        };
      })();
    </script>
  </body>
</html>